<div class="tab details {{tab.cssClass}}" data-group="primary" data-tab="details">
  <div class="actor-traits">
    <a class="edit-section-button" data-action="selectSubtraits" data-tooltip="{{localize "UTOPIA.Actor.editTraits"}}"><i class="fas fa-pen-to-square fa-fw"></i></a>
    {{> "actor-trait" trait=traits.agi subtraitLeft=traits.spd subtraitRight=traits.dex automated=automated}}
    {{> "actor-trait" trait=traits.str subtraitLeft=traits.pow subtraitRight=traits.for automated=automated}}
    {{> "actor-trait" trait=traits.int subtraitLeft=traits.eng subtraitRight=traits.mem automated=automated}}
    {{> "actor-trait" trait=traits.wil subtraitLeft=traits.res subtraitRight=traits.awa automated=automated}}
    {{> "actor-trait" trait=traits.dis subtraitLeft=traits.por subtraitRight=traits.stu automated=automated}}
    {{> "actor-trait" trait=traits.cha subtraitLeft=traits.app subtraitRight=traits.lan automated=automated}}
  </div>
  
  <div class="point-blocks">
    <fieldset>
      <legend>{{localize 'UTOPIA.CommonTerms.points'}}</legend>
      <div class="flexrow data-blocks">
        
        <div class="data-overlay">
          <i class="fa-solid fa-shield fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Points.body'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.points.body.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.points.body.bonus"
              value={{system.points.body.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Points.body'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-brain fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Points.mind'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.points.mind.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.points.mind.bonus"
              value={{system.points.mind.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Points.mind'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-flame fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Points.soul'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.points.soul.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.points.soul.bonus"
              value={{system.points.soul.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Points.soul'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      
      </div>
    </fieldset>

    <fieldset>
      <legend>{{localize 'UTOPIA.CommonTerms.attributes'}}</legend>
      <div class="flexrow data-blocks">
        
        <div class="data-overlay">
          <i class="fa-solid fa-block-brick fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Attributes.constitution'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.attributes.constitution.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.attributes.constitution.bonus"
              value={{system.attributes.constitution.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Attributes.constitution'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-rabbit-running fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Attributes.endurance'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.attributes.endurance.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.attributes.endurance.bonus"
              value={{system.attributes.endurance.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Attributes.endurance'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-sparkles fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Attributes.effervescence'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.attributes.effervescence.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.attributes.effervescence.bonus"
              value={{system.attributes.effervescence.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Attributes.effervescence'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      
      </div>
    </fieldset>

    <fieldset>
      <legend>{{localize 'UTOPIA.CommonTerms.travel'}}</legend>
      <div class="flexrow data-blocks">
        
        <div class="data-overlay">
        <i class="fa-solid fa-mountain fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Travel.land'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.travel.land.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.travel.land.bonus"
              value={{system.travel.land.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Travel.land'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-person-swimming fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Travel.water'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.travel.water.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.travel.water.bonus"
              value={{system.travel.water.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Travel.water'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-person-fairy fa-fw" data-tooltip="{{localize 'UTOPIA.Actor.Travel.air'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.travel.air.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.travel.air.bonus"
              value={{system.travel.air.bonus}}
              data-tooltip="{{localize 'UTOPIA.Actor.Travel.air'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      
      </div>
    </fieldset>

    <fieldset>
      <legend>{{localize 'UTOPIA.CommonTerms.defenses'}}</legend>

      <div class="flexrow data-blocks">
        <div class="data-overlay">
          <i class="fa-solid fa-snowflake fa-fw" data-tooltip="{{localize 'UTOPIA.DamageTypes.chill'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.defenses.chill.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.defenses.chill.bonus"
              value={{system.defenses.chill.bonus}}
              data-tooltip="{{localize 'UTOPIA.DamageTypes.chill'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-bolt fa-fw" data-tooltip="{{localize 'UTOPIA.DamageTypes.energy'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.defenses.energy.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.defenses.energy.bonus"
              value={{system.defenses.energy.bonus}}
              data-tooltip="{{localize 'UTOPIA.DamageTypes.energy'}}"
              data-action="updateField"/>
          {{/if}}
        </div>

        <div class="data-overlay">
          <i class="fa-solid fa-fire fa-fw" data-tooltip="{{localize 'UTOPIA.DamageTypes.heat'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.defenses.heat.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.defenses.heat.bonus"
              value={{system.defenses.heat.bonus}}
              data-tooltip="{{localize 'UTOPIA.DamageTypes.heat'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      
        <div class="data-overlay">
          <i class="fa-solid fa-hand-fist fa-fw" data-tooltip="{{localize 'UTOPIA.DamageTypes.physical'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.defenses.physical.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.defenses.physical.bonus"
              value={{system.defenses.physical.bonus}}
              data-tooltip="{{localize 'UTOPIA.DamageTypes.physical'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      
        <div class="data-overlay">
          <i class="fa-solid fa-brain fa-fw" data-tooltip="{{localize 'UTOPIA.DamageTypes.psyche'}}"></i>
          {{#if automated}}
            <span class="data-number">
              {{numberFormat system.defenses.psyche.total decimals=0}}
            </span>
          {{else}}
            <input type="number" 
              class="data-number"
              name="system.defenses.psyche.bonus"
              value={{system.defenses.psyche.bonus}}
              data-tooltip="{{localize 'UTOPIA.DamageTypes.psyche'}}"
              data-action="updateField"/>
          {{/if}}
        </div>
      </div>
    </fieldset>
  </div>

  <div class="actor-resources">
    <fieldset>
      <legend>
        <button type="button" data-action="addResource">
          <i class="fas fa-plus"></i>
          <span>{{localize "UTOPIA.Math.add"}}</span>
        </button>
      </legend>
      
      <table>
        <tr>
          <th class="resources-name">Name</th>
          <th class="resources-description">Description</th>
          <th class="resources-value">Value</th>
          <th class="resources-max">Max</th>
          <th class="resources-source">Source</th>
          <th class="resources-controls"></th>
        </tr>

        {{#each system.itemResources as |resource|}}
          <tr data-document-class="Item" data-item-id="{{resource.source}}">
            <th>
              {{formInput ../systemFields.resource.fields.name value=resource.name name=(concat "system.resources." @index ".name") localize=true disabled=(ne resource.source null)}}
            </th>
            <td>
              {{formInput ../systemFields.resource.fields.description value=resource.description name=(concat "system.resources." @index ".description") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{formInput ../systemFields.resource.fields.amount value=resource.amount name=(concat "system.resources." @index ".amount") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{formInput ../systemFields.resource.fields.max.fields.formula value=resource.max.total name=(concat "system.resources." @index ".max.total") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{#if (ne resource.source null)}}
                <a data-action="viewDoc" data-target="{{resource.source}}">
                  <i class="fas fa-up-right-from-square"></i>
                </a>
              {{else}}
                <i class="fas fa-arrow-down-to-line"></i>
              {{/if}}
            </td>
            <td>
              <button type="button" disabled>
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        {{/each}}

        {{#each system.actorResources as |resource|}}
          <tr data-document-class="Item" data-item-id="{{resource.source}}">
            <th>
              {{formInput ../systemFields.resource.fields.name value=resource.name name=(concat "system.resources." @index ".name") localize=true disabled=(ne resource.source null)}}
            </th>
            <td>
              {{formInput ../systemFields.resource.fields.description value=resource.description name=(concat "system.resources." @index ".description") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{formInput ../systemFields.resource.fields.amount value=resource.amount name=(concat "system.resources." @index ".amount") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{formInput ../systemFields.resource.fields.max.fields.formula value=resource.max.total name=(concat "system.resources." @index ".max.total") localize=true disabled=(ne resource.source null)}}
            </td>
            <td>
              {{#if (ne resource.source null)}}
                <a data-action="viewDoc" data-target="{{resource.source}}">
                  <i class="fas fa-up-right-from-square"></i>
                </a>
              {{else}}
                <i class="fas fa-arrow-down-to-line"></i>
              {{/if}}
            </td>
            <td>
              <button type="button" data-action="deleteResource" data-index="{{@index}}">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        {{/each}}
      </table>
    </fieldset>
  </div>
</div>